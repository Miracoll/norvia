{% extends 'manager/base.html' %}
{% load static %}
{% block content %}
<div class="content-body">
	<div class="container-fluid">

		<!-- Breadcrumb -->
		<div class="row">
			<div class="col-xl-12">
				<div class="page-titles">
					<nav style="--bs-breadcrumb-divider: '>';">
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="{% url 'home' %}">Dashboard</a></li>
							<li class="breadcrumb-item active">Users</li>
						</ol>
					</nav>
				</div>
			</div>
		</div>

		<!-- Page Header -->
		<div class="page-header">
			<h1 class="page-title">All Users ({{users.count}})</h1>
		</div>

		<!-- Filters -->
		<div class="filters-card">
			<div class="filters-row">
				<input type="text" class="filter-input" placeholder="Search by name or email...">
				<select class="filter-select">
					<option>All Status</option>
					<option>Active</option>
					<option>Suspended</option>
					<option>Pending</option>
				</select>
				<select class="filter-select">
					<option>All KYC Status</option>
					<option>Verified</option>
					<option>Unverified</option>
					<option>Pending</option>
				</select>
				<select class="filter-select">
					<option>Registration Date</option>
					<option>Last 7 days</option>
					<option>Last 30 days</option>
					<option>Last 90 days</option>
				</select>
			</div>
			<button class="btn btn-primary" type="submit">Apply Filters</button>
		</div>

		<!-- Users Table -->
		<div class="users-table-card">
			<div class="table-responsive">
				<table class="users-table">
					<thead>
						<tr>
							<th>User</th>
							<th>Status</th>
							<th>KYC</th>
							<th>Last Login</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for user in users %}
						<tr>
							<td>
								<div class="user-info">
									<div class="user-avatar">{{user.first_name|slice:1|upper}}{{user.last_name|slice:1|upper}}</div>
									<div class="user-details">
										<div class="user-name">{{user.first_name|capfirst}} {{user.last_name|capfirst}}</div>
										<div class="user-email">{{user.email}}</div>
									</div>
								</div>
							</td>
							<td><span class="status-badge {% if user.ban %} suspended {% else %} active {% endif %}">{% if user.ban %}Suspended{% else %}Active{% endif %}</span></td>
							<td><span class="kyc-badge {{user.kyc_status}}">{{user.kyc_status|capfirst}}</span></td>
							<td>
								{% if user.last_login %}
									{{ user.last_login|timesince }} ago
								{% else %}
									Never
								{% endif %}
							</td>
							<td>
								<div class="action-buttons">
									<a href="{% url 'admin_user_detail' user.username %}" class="btn-action view" title="View Details">
										<i class="material-icons">visibility</i>
									</a>
									<form method="POST" action="" style="display: inline;">
										{% csrf_token %}
										<input type="hidden" name="username" value="{{user.username}}">
										<button type="submit" class="btn-action suspend" title="Suspend User">
											<i class="material-icons">block</i>
										</button>
									</form>
								</div>
							</td>
						</tr>
						{% endfor %}
						
					</tbody>
				</table>
			</div>
		</div>

	</div>
</div>
{% endblock %}