{% extends "account/base.html" %}
{% load static %}

{% block title %}Withdraw{% endblock %}

{% block body_class %}page-withdraw{% endblock %}

{% block content %}

        <!--**********************************
            Sidebar end
        ***********************************-->

		<!--**********************************
			Content body start
		***********************************-->
		<div class="content-body default-height">
			<!-- row -->
			<div class="container-fluid">
				<!-- Row -->
				<div class="row">
					<div class="col-xl-12">
						<div class="row">
							<div class="col-xl-12">
								<div class="page-titles">
									<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
										<ol class="breadcrumb">
										  <li class="breadcrumb-item"><a href="{% url 'home' %}">Dashboard</a></li>
										  <li class="breadcrumb-item active" aria-current="page">Withdraw</li>
										</ol>
									  </nav>
								</div>
							</div>
						</div>

						<div class="card">
							<div class="card-body">
								<div class="row justify-content-center">
									<!-- Center Column - Withdraw Form -->
									<div class="col-xl-8 col-lg-10">
										<h4 class="card-title mb-4" style="font-size: 22px; font-weight: 700;">Withdraw Funds</h4>

										<!-- Available Balance -->
										<div class="balance-card">
											<div class="balance-label">Available Balance</div>
											<div class="balance-amount" id="availableBalance">${{request.user.balance}}</div>
											<button class="balance-max-btn" onclick="setMaxAmount()">
												<i class="material-icons" style="font-size: 14px; vertical-align: middle;">arrow_upward</i>
												Withdraw Max
											</button>
										</div>

										<!-- Payment Method Selection -->
										<div class="payment-methods mb-5">
											<label class="form-label fw-bold mb-3">Select Withdrawal Method</label>
											<ul class="nav nav-pills row g-3" role="tablist">
												<li class="nav-item col-md-6" role="presentation">
													<button class="payment-method-card active w-100" id="crypto-tab" data-bs-toggle="pill" data-bs-target="#cryptoSection" type="button" role="tab">
														<i class="material-icons">currency_bitcoin</i>
														<span>Cryptocurrency</span>
													</button>
												</li>
												<li class="nav-item col-md-6" role="presentation">
													<button class="payment-method-card w-100" id="gateway-tab" data-bs-toggle="pill" data-bs-target="#gatewaySection" type="button" role="tab">
														<i class="material-icons">payment</i>
														<span>Payment Gateway</span>
													</button>
												</li>
											</ul>
										</div>

										<!-- Withdraw Form -->
										<form id="withdrawForm" method="post">
											{% csrf_token %}
											<!-- Withdraw From Wallet Selection -->
											<div class="form-group mb-4">
												<label class="form-label fw-bold">Withdraw From</label>
												<select id="walletSelect" class="withdraw-select" name="withdraw_from">
													<option value="trading" selected>Trading Wallet</option>
													<option value="holding">Holding Wallet</option>
												</select>
												<small class="text-muted d-block mt-2">
													<i class="material-icons" style="font-size: 14px; vertical-align: middle;">info</i>
													Select which wallet to withdraw funds from
												</small>
											</div>

											<div class="tab-content">
												<!-- Crypto Section -->
												<div class="tab-pane fade show active" id="cryptoSection" role="tabpanel">
												<!-- Currency Selection -->
												<div class="form-group mb-4">
													<label class="form-label fw-bold">Select Currency</label>
													<select id="currencySelect" class="withdraw-select" onchange="updateCurrencyLabel()" name="currency">
														<option value="btc">Bitcoin (BTC)</option>
														<option value="eth">Ethereum (ETH)</option>
														<option value="usdt" selected>Tether (USDT)</option>
														<option value="bnb">Binance Coin (BNB)</option>
														<option value="sol">Solana (SOL)</option>
													</select>
												</div>

												<!-- Network Selection -->
												<div class="form-group mb-4">
													<label class="form-label fw-bold">Select Network</label>
													<select id="networkSelect" class="withdraw-select" name="network">
														<option value="erc20">ERC20 (Ethereum)</option>
														<option value="trc20" selected>TRC20 (Tron)</option>
														<option value="bep20">BEP20 (BSC)</option>
													</select>
													<small class="text-muted d-block mt-2">
														<i class="material-icons" style="font-size: 14px; vertical-align: middle;">warning</i>
														Make sure the withdrawal address supports this network
													</small>
												</div>

												<!-- Withdrawal Address -->
												<div class="form-group mb-4">
													<label class="form-label fw-bold">Withdrawal Address</label>
													<input type="text" id="withdrawAddress" class="withdraw-input" placeholder="Enter your wallet address" name="address">
													<small class="text-muted d-block mt-2">
														<i class="material-icons" style="font-size: 14px; vertical-align: middle;">info</i>
														Double-check your address. Transactions cannot be reversed.
													</small>
												</div>
												</div>

												<!-- Gateway Section -->
												<div class="tab-pane fade" id="gatewaySection" role="tabpanel">
												<!-- Payment Gateway Selection -->
												<div class="form-group mb-4">
													<label class="form-label fw-bold">Select Payment Method</label>
													<select id="gatewaySelect" class="withdraw-select" name="gateway">
														<option value="" disabled selected>Choose a payment method</option>
														<option value="paypal">PayPal</option>
														<option value="zelle">Zelle</option>
														<option value="cashapp">Cash App</option>
														<option value="venmo">Venmo</option>
														<option value="bank">Bank Transfer</option>
													</select>
												</div>

												<!-- Payment Account Details -->
												<div class="form-group mb-4">
													<label class="form-label fw-bold">Account Email/Phone</label>
													<input type="text" id="gatewayAccount" class="withdraw-input" placeholder="Enter your account email or phone" name="email">
													<small class="text-muted d-block mt-2">
														<i class="material-icons" style="font-size: 14px; vertical-align: middle;">info</i>
														Enter the email or phone number associated with your payment account
													</small>
												</div>
												</div>

											<!-- Amount Input -->
											<div class="form-group mb-4">
												<label class="form-label fw-bold">Amount (USD)</label>
												<div class="amount-input-wrapper">
													<span class="input-prefix">$</span>
													<input type="number" id="withdrawAmount" placeholder="Enter amount" min="20" step="0.01" name="amount">
													<span class="input-suffix" id="currencyLabel">USDT</span>
												</div>
												<small class="text-muted d-block mt-2">Minimum withdrawal: $20.00</small>
											</div>

											<!-- Fee Display -->
											<div class="mb-5">
												<div class="fee-breakdown">
													<div class="fee-row">
														<span>Withdrawal Amount:</span>
														<span id="displayAmount">$0.00</span>
													</div>
													<div class="fee-row">
														<span>Network Fee:</span>
														<span id="displayFee">$0.00</span>
													</div>
													<div class="fee-row total">
														<span><strong>You Will Receive:</strong></span>
														<span><strong id="displayTotal">$0.00</strong></span>
													</div>
												</div>
											</div>

											<!-- Submit Button -->
											<button type="submit" class="btn btn-primary btn-lg w-100" style="height: 58px; font-size: 16px; font-weight: 600; border-radius: 12px;">
												<i class="material-icons me-2" style="vertical-align: middle; font-size: 20px;">send</i>
												Request Withdrawal
											</button>
											</div>
										</form>

										<!-- Important Information -->
										<div class="alert alert-warning mt-4" style="border-radius: 12px; border-left: none;">
											<h6 class="alert-heading"><i class="material-icons me-2" style="vertical-align: middle;">warning</i>Important Information</h6>
											<ul class="mb-0 ps-3" style="font-size: 14px;">
												<li>Minimum withdrawal: $20.00 USD</li>
												<li>Double-check your wallet address before submitting</li>
												<li>Withdrawals are processed within 24-48 hours</li>
												<li>Network fees will be deducted from your withdrawal amount</li>
												<li>Ensure your account is verified (KYC) to avoid delays</li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--**********************************
			Content body end
		***********************************-->
{% endblock %}
